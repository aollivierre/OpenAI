Act as a professional English writer. Write in a technical and friendly tone. Help me compose a detailed status report update of the following troubleshooting that we that I have done so far on a RH arm pure Regional Health scan to e-mail issue so recently it looks like this customer has for security reasons has to take down his well there there there there exchange servers right there on premise Exchange Server which caused all their Ricoh copiers and multifunction printers ascentia Lee that includes the scanning functionality to stop working it's particularly the the scan to e-mail function stop stop working and because of that they they had to you know to contact us for four as their service provider to provide support in getting those those while those copiers and particularly the scan to e-mail function up and running back again given that the exchange servers or or what would it wish it had to be taken offline for security reasons essentially and so I I was I was myself I was reached out contacted by my senior engineer Maggie in order to investigate this problem and to define a resolution given that it's an urgent issue and that and that the customer has been waiting for a couple weeks now and and and the issue has not been resolved thus far so so as part of my analysis and in troubleshooting here's what what has been has been done so far I have first of all gained access to the on peer Regional Health authoritie Office 365 already had an account but it didn't really have I global admin permissions or any special permissions in to the tenant that allows me to administer the Office 365 tenant but I have to contact him my colleague alley given that he is he was working on the ticket he you know he kindly shared his his credentials and a lot which allowed me to grant myself you know admin admin level permissions into the tenant in order to allow for four administration of this tenant and then from there I was able to start analyzing the sort of the DNS settings and the SMTP settings on that tenant what we've noticed that the tenant was using an e-mail account that was already created called scan to e-mail or scan to mail at at rpeerhealth.ca however that account was not ah was not sending SMTP because the SMTP auth was disabled at the tenant level and because the SMTP auth was stable at the tenant level we had to enable it using a PowerShell ascentia Lee on the on the Microsoft website there's a PowerShell command to allow SMTP auth at the Office 365 level and then after that we created a test account called SMTP test 001 arm your health Seattle allow for testing the SMTP functionality using a PowerShell script so just said the PowerShell the SMTP function at using PowerShell from port 587 on on my machine here on my on my Nova machine and then and then that that that sends successfully using port 5/8 at 587 an with SSL turned on so that is option one ah it listed on the Microsoft website and then and then I tested that same PowerShell function PowerShell script with with basically sending sending SMTP emails port 587 from from the arm peer regional half virtual machine on on the on the 90 submit and then from there I was able to test successfully and then and then you know started to do advanced IP scan on that subnet to discover the Ricoh printers that are better essentially on the network and then and then and then essentially after ensuring that multi factor authentication is not enabled on that account on the SMTP test account that I created otherwise if it was enabled it would cause issues because SMTP auth is a basic SMTP auth is non interactive and I cannot does know how to work with with you know modern off like multi factor authentication so we made sure MFA is disabled security forces table there's no conditional access basically we made sure every possible mechanism that could potentially introduce multi factor authentication is disabled including conditional access security defaults and so on and then from there we ensure that now the account is is programmed into we started with with one test printer initially discovered eight printers but then later on realized that there are a lot more than that and I'll explain that in a moment but then we start with testing with one printer and that was the initially there the sort of the second floor copier there and then we were able to actually best through that but it failed so we moved from from from that method to using another method on the Microsoft website there were three methods proposed or or suggested to actually set up a multifunction printer with SMTP either using an SMTP auth or using MX records were using a relay like like an exchange relay essentially connector or really an so we tried option two which is using the MX record this time on port 25 however an it worked an so which means that the dot not the 90 subnet um has port port 25 open R&N and port 587 potentially not open or or maybe the copiers do not support TLS version 1.2 so it could mean different things but we're not 100% conclusive on that but what we what we found out later on we worked with our contact there the customer her name is Roslyn Roslyn allowed us to you know discover more printers an she sent us a list of all the Ricoh printers that are live on the network sentence list of 26 printers to be particular and then he is a PowerShell script to do a pink cast an HTTP test as well as an HTTPS basically testing for both ports ICMP again in force ports 80 and ports 443 on those IP addresses of the Ricoh printers to verify if the web user interfaces up and running for them and indeed 25 out of 26 were actually live except for you know except that that last one was not responding was not pinnable so we preceded with logging into the 25 Ricoh printers using the default add new logins except for one it did not work for the default admin logins it was slightly different password for that but aside from that we were able to from the 90 subnet navigate anan be able to have a clear line of sight in terms of network connectivity to all the 25 Ricoh printers were able to have an administrative login all each one of them and we updated the the SMTP settings under device settings on the device e-mail settings from what it was before the old century old MX records into the new MX records and then we test it and then what we found out another issue is that the one of the other copiers which is the office copier that's located on a different subnet did not work with the MX record method however it worked with the SMTP auth method again not conclusively but suggesting that port 25 is not open on that subnet however port 587 is open so overall there are multiple components into this there's a networking piece and there's an SMTP PS and there's multiple different pieces but we verified this morning functionality from that subnet from the 97 and so after analyzing the sort of the the table or the data set for for our printers lesser Ricoh printers and copiers and their IP addresses what we found out that there are four distinct for unique subnets which the the 25 basically Ricoh copiers are distributed across and so we needed a sort of an approach where we test at least one copier per subnet to verify that communication on ports 25 imports 587 so that we make sure that every subnet is allowed to send and communicate over these ports and so with that being said we had to breakdown this this verification this test we still have more more tests to do on 2 remaining subnets but so far two out of the four unique subnets have been tested and when I see testing we tested one copy or at least per subnet and we have two more unique subnets meaning at least one one printer per subnet to test to verify whether port 25 or port 587 preferably I mean we we want to go with port 587 because it's encrypted has SSL enabled where is port 25 is using the Amex record requires SPF DNS record modification at the DNS at the worldwide DNS record level and so the MX record is not as preferable because due to the lack of encryption so we prefer five 80s will probably try to privatize 587 troubleshoot for that and so for that as much as we can and if that doesn't work then we sort of you know fail back to the port port 25 which is plain text really it's not not so encrypted and so from there we essentially we we we sort of we ended up with sort of with a number of PowerShell scripts you know one PowerShell script sort of to test you know ping HTTP and HTTPS on the Ricoh IP addresses another partial script to test SMTP e-mail like to send SMTP over 54587 another PowerShell script to test SMTP over or well essentially port port 25 and then and then you know we've also tested another while another PowerShell script to verify if port 25 or port 587 RR have any rules whatsoever on the windows firewall level like at the at the soft firewall and we didn't find any rules whatsoever suggesting that port 25 in port 587 at least they're not being blocked add the windows firewall level which is good but that doesn't necessarily conclude that they are being blocked at the at the gateway at the physical appliance level so we are still waiting for Roslyn to come back to us so we can test two more subnets that last two remaining unique subnets out of the four the overall like the total 4/4 unique subnets on that and we are still we're still waiting absolutely we are definitely waiting and we're going to be working a little more to in order to buy but overall I would say we have definitely made some really good progress on this task and and we will be making some more more progress throughout throughout the remaining of the week here and making sure that all of our copiers here Ricoh copiers that are live on the network all have the scant e-mail functionality restore back via the updated Office 365 SMTP settings and from there we gotta make sure that customers happy and all their copiers are essentially are functional and enable to do scan to e-mail via via SMTP something to note that we have used excel Microsoft XLS part of our sort of data analysis and make sure that we're getting sort of clear clear understanding of where sort of where the printers resides on which subnets in which IP addresses we've also extracted so the unique the unique subnets from each IP address and and we I also updated the the data set that is sort of the data set that was provided to us by Roslyn we updated updated that with the friendly description sort of the location name of each printer now there are more printers non Ricoh printers like other models like completely other different manufacturers not just like non Ricoh printers that exists on the print server but we worry about those later however for now a priority is to continue troubleshooting and investigating the issues with scant e-mail functionality on the Ricoh printers and then from there we're going to make sure that the automatic reports are sent through some of their applications like you know like building automation in pharmacy or also functional once we get those I think once we get those Ricoh printers because you know if we can get at least one Ricoh printer per subnet that will will will give us a clear idea of where we stand out today in terms of the networking aspect on those subnets and that will sort of cover our basis into going into an start once we've done with the Ricoh printers do the automatic reports within the application so we've got so on one side we've got copiers that leverages scant e-mail functionality cantina functionality and the other side we've got applications that also leverages scanty malfunction so our focus right now is only copiers once we get that going and then we're going to go with the with the automatic reports essentially right so so we are still working on that we have really made some good progress I have also updated my supervisor John John Fawcett on this on this progress so far and he's pretty happy with the progress and we are definitely making some some some really good good progress with that and and yeah and you know we're we're really we're going to be making some some motion here with some real tangible results in and throughout the week in the next couple days and ensuring that you know we cover our bases and make sure that all the printers and copiers are able to restore the scan e-mail functionality using the new updated Office 365 SMTP settings as opposed to the pool as opposed to the exchange at the old on premises Exchange Server right and now going forward all the copiers will start leveraging either the SMTP auth option or the MX record option either ways start relaying through the Office 365 you know Office 365 relay is essentially going forward and so throughout that we've also we were also able to download the firmware update utility on that on that VM to discover if there's any firmware updates during the troubleshooting but we really I that one specific car but if we're testing with which is the IT office copier we'd really couldn't see that couldn't see that printer on the on the on the firmware using the firmware update utility um we were also able to create a open call called support call called the Ricoh Canada support an open open a support case with them as well as register & up for the my Ricoh my Rico website where we can track and create service requests and whatnot so were able to actually achieve that as well so that is a good achievement so we got that on the back of her pocket as sort of a Swiss army knife kind of thing you know to reach out to escalate to Rico in case we run into any further issues and think things like that but I think so far we're we're pretty confident that that seems like you know after doing some really deep analysis with especially with with testing ports right we haven't really gotten into installing Wireshark or anything like that or packet sniffing we haven't really done any we haven't really engaged the networking team to do packet sniffing at the well at the networking level at the firewall level but we may do that however what we did for now just a simple downloaded the system journals TCP view our utility to just watch for port 25 in port 587 on the outbound we try to telnet into the entertaining into the MX record as well but of course connection failed because obviously you know calendar 25 probably incoming telnet or incoming port 25 on the MX record for officers throughout the on Microsoft one is is problem is well not probably blocked so we tried telnetting using the the windows stand telnet as well as a as a third party talent agent which is putty and both both concluded that the incoming 2425 on the MX record is blocked and so but we tried outbound using PowerShell sending sending using the partial functionality and we were able to achieve that sending out not on my computer probably my Shaw network here my ISP network here at home is blocking port 25 outbound but on the customers side were able to do it through port 25 Alice on that subnet on the 97 we were also able to download security logs and that was a really interesting one as well the secure logs were fairly big actually about 3 to 4 megabytes per file and it wasn't a CSV format it was pretty well structured I would say And really analyze that data set as well the scooter logs for the two copiers that we have tested so far is his second floor copier as well as the office copier and were able to analyze the security logs and find out that the analogs it does indeed show the scan scanner functionality has successfully completed sending and we were able to verify that in the mailbox as well in the SMTP test mailbox as well as in my mailbox which is 2 records created in the address book in these two printers we've created two more address book records in each of the two remaining printers and two remaining unique sadness that we will be testing with probably tomorrow as well so tomorrow we'll be adding more more updates to this ticket on our findings and where we add today with this but so far here's what we have done we have you know enabled SMTP auth at the organization level using PowerShell we have created an SMTP test account we verified multi factor of is disabled via policy or via the legacy MFA at the user level at the at the at the conditional access level we've also then made sure that port 587 port 25 or are indeed communicating on on those specific subnets actually they were for unique subnets and we can we can provide more datasets into well essentially into this as well but but it's just to basically show the printers and show their models and serial numbers and all that all that IP addresses and all the subnets and all this sort of analysis that we have done using excel off that data set and then from there we were able to actually come up with the conclusion that well look you know there's a networking peace and there's an SMT ***** and most importantly you know we've also disabled password expiration basically we set the password expiration policy on that account on the SMTP auth account to none or to disable basically not to expire password to avoid having any returning potential issues in the future where where the password expires and then add a sudden you know this call would cause inadvertently all the copiers to stop working essentially so we were able to achieve that and to save a password expiration using the updated Microsoft graph PowerShell modules and and we can certainly provide more code scripts automation scripts that we've the automation scripts that were used in this in this exercise and all that all that sort of all that good stuff right socially all the scripts and all the all the all the documentation all the excel files and whatnot so with that being said we can now conclude this status report update and go from there